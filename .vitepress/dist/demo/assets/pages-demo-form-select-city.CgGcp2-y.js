import{d as e,ae as l,r as a,B as t,c as s,ac as o,aD as c,ad as u,e as i,f as n,g as r,n as d,j as p,w as m,V as f,F as v,p as y,v as h,b7 as _,h as b,k as g,t as j,D as V,x as k,b8 as x,o as C,b9 as K}from"./index-Dlau7bkh.js";import{P as w,_ as A}from"./cl-select-inner.D5P_UWNj.js";import{_ as R}from"./cl-tag.CClJOHWp.js";import{_ as S}from"./cl-list-index.B6fWYhH3.js";import{_ as B}from"./cl-select-popup.7bVSwqXn.js";import{a as D}from"./index.AbH2Jzti.js";import{C as F}from"./city-pca.BwKYHwgO.js";import{i as U,c as $,b as E}from"./cl-page.C3y_EXfh.js";import{c as G}from"./cloneDeep.B3v6UXnm.js";import{_ as H}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as P}from"./cl-card.BPBZxryb.js";import{_ as q}from"./cl-row.B3dS1wxL.js";import"./cl-input.Cxen37Qp.js";import"./cl-checkbox.CaJhdFam.js";import"./isBoolean.Bco7Ljdy.js";import"./cl-avatar.CmFnm4H6.js";import"./cl-empty.Cios8Ciw.js";import"./cl-text.DUw3LhC2.js";const z=H(e({name:"cl-select-city",props:{...w,data:{type:Array,default:F},modelValue:Array,title:{type:String,default:l("请选择所在地区")},labelKey:{type:String,default:"name"},valueKey:{type:String,default:"name"},placeholder:{type:String,default:l("请选择所在地区")},separator:{type:String,default:" - "}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{refs:i,setRefs:n}=D(),r=a([]),d=a(0),p=t((()=>{let l=e.data;const a=r.value.map((a=>{const t=l.find((l=>l[e.valueKey]==a));return t?(l=t.children||[],l):[]}));return[e.data,...a].filter((e=>!U(e)))})),m=t((()=>r.value.map(((l,a)=>p.value[a].find((a=>a[e.valueKey]==l)))))),f=a([]),v=t((()=>f.value.map((l=>null==l?void 0:l[e.labelKey])).join(e.separator)));function y(l){r.value=G(l||e.modelValue||[]),(U(r.value)||r.value.find((e=>!e)))&&(r.value=[""],d.value=0),f.value=m.value.filter(Boolean).map((e=>({...e,children:void 0})))}const h=s({list:[],create(){h.list=r.value.map(c)},update(){r.value.forEach(((e,l)=>{e||(h.list.splice(l,99),h.list[l]=c())}))}});function _(){i.popup.close()}function b(){l("update:modelValue",r.value),l("change",r.value),_()}return o((()=>e.modelValue),y,{immediate:!0,deep:!0}),{refs:i,setRefs:n,list:p,value:r,cache:h,text:v,tabs:m,selection:f,confirm:b,open:function(){i.popup.open(),y(),h.create()},close:_,select:function(l,a){r.value[a]&&r.value.splice(a,99),r.value[a]=l[e.valueKey];const t=p.value[a].find((l=>l[e.valueKey]==r.value[a]));U(null==t?void 0:t.children)?b():(r.value.push(""),h.update(),u((()=>{d.value+=1})))},onActiveChange:function(e){d.value=e.detail.current},active:d,toActive:function(e){d.value=void 0!==e?e:r.value.length}}}}),[["render",function(e,l,a,t,s,o){const c=i(n("cl-select-inner"),A),u=h,C=i(n("cl-tag"),R),K=k,w=i(n("cl-list-index"),S),D=x,F=_,U=i(n("cl-select-popup"),B);return r(),d(v,null,[p(u,{class:"cl-select-city",onClick:e.open},{default:m((()=>[f(e.$slots,"default",{value:e.modelValue,label:e.text,selection:e.selection},(()=>[p(c,{height:e.height,placeholder:e.placeholder,disabled:e.disabled,border:e.border,round:e.round,backgroundColor:e.backgroundColor,borderRadius:e.borderRadius,padding:e.padding,text:e.text},null,8,["height","placeholder","disabled","border","round","backgroundColor","borderRadius","padding","text"])]))])),_:3},8,["onClick"]),p(U,{ref:e.setRefs("popup"),title:e.title,"show-picker":!1,"show-footer":!1,"scroller-height":"70vh"},{list:m((()=>[p(u,{class:"cl-select-city__wrap"},{default:m((()=>[p(u,{class:"cl-select-city__tabs"},{default:m((()=>[(r(!0),d(v,null,y(e.tabs,((l,a)=>(r(),b(C,{key:a,round:"",type:e.active==a?"primary":"info",margin:[0,20,20,0],onClick:l=>e.toActive(a)},{default:m((()=>[g(j((null==l?void 0:l[e.labelKey])||e.$t("请选择")),1)])),_:2},1032,["type","onClick"])))),128))])),_:1}),p(u,{class:"cl-select-city__list"},{default:m((()=>[p(F,{current:e.active,onChange:e.onActiveChange},{default:m((()=>[(r(!0),d(v,null,y(e.list,((l,a)=>(r(),b(D,{key:e.cache.list[a]},{default:m((()=>[p(w,{data:l,"search-bar":!1,dict:{id:e.valueKey},delay:500},{item:m((({item:l})=>[p(u,{class:V(["cl-select-city__item",{"is-active":l[e.valueKey]==e.value[a]}]),onClick:t=>e.select(l,a)},{default:m((()=>[p(K,{class:"cl-icon-toast-success"}),p(K,null,{default:m((()=>[g(j(l[e.labelKey]),1)])),_:2},1024)])),_:2},1032,["class","onClick"])])),_:2},1032,["data","dict"])])),_:2},1024)))),128))])),_:1},8,["current","onChange"])])),_:1})])),_:1})])),confirm:m((()=>[])),_:1},8,["title"])],64)}]]),I=e({name:"undefined"}),J=e({...I,setup(e){const l=a([]),t=a([]),s=a([]),o=a();return C((()=>{K({url:"https://cool-service.oss-cn-shanghai.aliyuncs.com/app%2Fbase%2F8fe445f06db5463386ae940d45b4bd6c_city-pcas.json",success(e){o.value=e.data}})})),(e,a)=>{const c=i(n("cl-select-city"),z),u=i(n("cl-card"),P),f=i(n("cl-tag"),R),h=i(n("cl-row"),q),_=i(n("cl-button"),$),V=i(n("cl-page"),E);return r(),b(V,{padding:20},{default:m((()=>[p(u,{label:"基础用法"},{default:m((()=>[p(c,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e)},null,8,["modelValue"])])),_:1}),p(u,{label:"省市区乡镇4级"},{default:m((()=>[p(c,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),data:o.value,placeholder:"省市区县、乡镇"},null,8,["modelValue","data"])])),_:1}),p(u,{label:"自定义"},{default:m((()=>[p(c,{modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value=e)},{default:m((({selection:e})=>[p(h,null,{default:m((()=>[(r(!0),d(v,null,y(e,(e=>(r(),b(f,{margin:[0,20,20,0],plain:"",round:"",key:e.code},{default:m((()=>[g(j(e.name),1)])),_:2},1024)))),128))])),_:2},1024),p(_,{round:""},{default:m((()=>[g("选择所在地区")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}}});export{J as default};
