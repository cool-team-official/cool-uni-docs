import{_ as s}from"./cl-topbar.CvzCs08H.js";import{d as a,n as e,r as o,p as t,o as l,a as n,b as r,c,e as p,w as d,f as u,g as i,t as m,h as f,k as h,l as _}from"./index-BXs9N0aO.js";import{_ as g}from"./cl-captcha.B21bXEDB.js";import{b,a as j}from"./cl-page.D0l32468.js";import{u as C,_ as v}from"./_plugin-vue_export-helper.D4XvEQHf.js";import{u as x}from"./index.BeCewKBR.js";import{S as k}from"./sms-btn.DwP19pnX.js";import"./cl-text.FIltvNqU.js";import"./cl-input.CAOkH06t.js";const w=v(a({__name:"captcha",setup(a){const{service:v,router:w,refs:y,setRefs:V}=C(),{user:z}=e(),B=x(),T=o(!1),q=t({smsCode:"",phone:""});function D(){T.value=!0,v.user.login.phone(q).then((async s=>{z.setToken(s),await z.get(),w.nextLogin()})).catch((s=>{B.showTips(s.message||"登录失效，请重试~"),T.value=!1,q.smsCode=""}))}return l((()=>{q.phone=w.query.phone||"",y.smsBtn.startCountdown()})),(a,e)=>{const o=n(r("cl-topbar"),s),t=h,l=n(r("cl-captcha"),g),C=_,v=n(r("cl-button"),b),x=n(r("cl-page"),j);return c(),p(x,{"background-color":"#fff"},{default:d((()=>[u(C,{class:"page-captcha"},{default:d((()=>[u(o,{border:!1}),u(C,{class:"container"},{default:d((()=>[u(t,{class:"label"},{default:d((()=>[i("输入验证码")])),_:1}),u(t,{class:"tips"},{default:d((()=>[i("已发送至 +86 "+m(q.phone),1)])),_:1}),u(C,{class:"code"},{default:d((()=>[u(l,{focus:"",modelValue:q.smsCode,"onUpdate:modelValue":e[0]||(e[0]=s=>q.smsCode=s),length:4,gutter:26,onDone:D},null,8,["modelValue"])])),_:1}),u(v,{type:"primary",disabled:4!==q.smsCode.length,loading:T.value,fill:"",height:90,"font-size":30,onClick:D},{default:d((()=>[i(" 确定 ")])),_:1},8,["disabled","loading"]),u(C,{class:"send"},{default:d((()=>[u(k,{size:"small",border:!1,phone:q.phone,ref:f(V)("smsBtn")},null,8,["phone"])])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-6387bda1"]]);export{w as default};
