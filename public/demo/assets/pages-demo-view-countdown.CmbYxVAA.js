import{d as e,f as t,a8 as a,a9 as l,aa as o,ab as u,o as n,a as s,w as r,v as i,F as d,x as c,b as m,q as f,t as p,G as y,i as h,k as v,l as b,p as g}from"./index-BsPE-n5_.js";import{p as _,a as x}from"./cl-page.D-7WxXOa.js";import{_ as S}from"./_plugin-vue_export-helper.B5Vkt9du.js";import{_ as j}from"./cl-card.CcFW5yJQ.js";import"./cl-text.Dmi3_oh8.js";const w=S(e({name:"cl-countdown",props:{format:{type:String,default:"{h}:{m}:{s}"},simple:{type:Boolean,default:!1},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},datetime:[Date,String],numberStyle:Object,textStyle:Object,fontSize:{type:Number,default:26}},emits:["stop","done","change"],setup(e,{emit:n}){let s=null;const r=t(0);let i=!1;const d=t(!0),c=t([]);function m({day:e=0,hour:t=0,minute:a=0,second:l=0,datetime:o}){return o?(new Date(o.replace(/-/g,"/")).getTime()-(new Date).getTime())/1e3:60*e*60*24+60*t*60+60*a+l}function f(t){d.value=!0,u((()=>{let{day:a,hour:l,minute:o,second:u,datetime:f}=t||{};a||(a=e.day),l||(l=e.hour),o||(o=e.minute),u||(u=e.second),f||(f=e.datetime),r.value=m({day:a,hour:l,minute:o,second:u,datetime:f}),function(){if(r.value<=0)return;if(i)return;function t(){if(function(){let[t,a,l,o]=[0,0,0,0];t=Math.floor(r.value/86400),a=Math.floor(r.value/3600)-24*t,l=Math.floor(r.value/60)-24*t*60-60*a,o=Math.floor(r.value)-24*t*60*60-60*a*60-60*l,t<10&&(t="0"+t);a<10&&(a="0"+a);l<10&&(l="0"+l);o<10&&(o="0"+o);const u={d:t,h:a,m:l,s:o};let s=e.format.split(/[{,}]/).filter(Boolean).map((e=>({value:u[e]?u[e]:e,ch:void 0===u[e]}))),i=!0,d=-1;c.value=s.map(((t,a)=>(e.simple&&(t.ch||i&&("00"==t.value?(d=a,i=!0):i=!1)),t))).filter(((e,t)=>-1==d||d+1<t)),n("change",c.value.map((e=>e.value)))}(),r.value<=0)return d.value=!1,p(),void n("done");r.value--,s=setTimeout(t,1e3)}i=!0,t()}()}))}function p(){clearTimeout(s),s=null,i=!1}return a(p),l(f),o((()=>e.day),f),o((()=>e.hour),f),o((()=>e.minute),f),o((()=>e.second),f),o((()=>e.datetime),f),{visible:d,seconds:r,list:c,start:f,stop:function(){p(),n("stop")},toSeconds:m,parseRpx:_}}}),[["render",function(e,t,a,l,o,u){const v=h;return e.visible?(n(),s(v,{key:0,class:"cl-countdown",style:m({"font-size":e.parseRpx(e.fontSize)})},{default:r((()=>[(n(!0),i(d,null,c(e.list,((t,a)=>(n(),s(v,{key:a,class:"cl-countdown__item",style:m(t.ch?e.textStyle:e.numberStyle)},{default:r((()=>[f(p(t.value),1)])),_:2},1032,["style"])))),128))])),_:1},8,["style"])):y("",!0)}]]);const N=S({},[["render",function(e,t){const a=v(b("cl-countdown"),w),l=v(b("cl-card"),j),o=v(b("cl-page"),x);return n(),s(o,{padding:20},{default:r((()=>[g(l,{label:"基础用法"},{default:r((()=>[g(a,{hour:5})])),_:1}),g(l,{label:"精简模式"},{default:r((()=>[g(a,{hour:1,simple:""})])),_:1}),g(l,{label:"自定义格式"},{default:r((()=>[g(a,{hour:5,format:"{d}天{h}时{m}分{s}秒后结束"})])),_:1}),g(l,{label:"自定义样式"},{default:r((()=>[g(a,{hour:5,"font-size":40,"number-style":{backgroundColor:"#f56c6c",color:"#fff",borderRadius:"8rpx",padding:"6rpx",margin:"0 6rpx"}})])),_:1})])),_:1})}]]);export{N as default};
