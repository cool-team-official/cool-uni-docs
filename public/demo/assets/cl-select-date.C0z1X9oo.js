import{P as e,_ as t}from"./cl-select-inner.KrdzpX5M.js";import{d as a,f as l,c as o,as as s,ab as r,k as n,l as u,o as d,v as i,p as c,w as p,r as m,F as f,x as h,a as g,q as v,t as b,i as _,bd as y,be as k}from"./index-BsPE-n5_.js";import{b as C}from"./cl-page.D-7WxXOa.js";import{_ as x}from"./cl-select-popup.BTiYlBFY.js";import{a as V,_ as Y}from"./_plugin-vue_export-helper.B5Vkt9du.js";import{r as j}from"./range.CDrfcn2n.js";const D=Y(a({name:"cl-select-date",props:{...e,modelValue:String,title:{type:String,default:"选择日期"},startYear:{type:Number,default:2e3},mode:{type:Array,default:["year","month","date","hour","minute","second"]},format:{type:String,default:"YYYY-MM-DD HH:mm:ss"},displayFormat:Function,start:String,end:String,placeholder:{type:String,default:"请选择时间"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{refs:a,setRefs:n}=V(),u=l(),d=l([]),i=o((()=>e.displayFormat?e.displayFormat(e.modelValue):e.modelValue)),c=o((()=>{const t=j(e.startYear,e.startYear+50),a=j(1,13),l=p(u.value).endOf("month").date(),o={year:{list:t,unit:"年"},month:{list:a,unit:"月"},date:{list:j(1,l+1),unit:"日"},hour:{list:j(24),unit:"时"},minute:{list:j(60),unit:"分"},second:{list:j(60),unit:"秒"}};return e.mode.map((e=>o[e]))}));function p(t){let a=s();if(t){let l=t.split(/\D+/g);e.mode.forEach(((e,t)=>{let o=Number(l[t]);"month"==e&&(o-=1),a=a.set(e,o)}))}return a}function m(t,a=!0){u.value=t||void 0;const l=p(u.value),o=e.mode.map(((e,t)=>{var a;let o=null==(a=l[e])?void 0:a.call(l);return"month"==e&&(o+=1),c.value[t].list.findIndex((e=>e==o))}));d.value=e.mode.map((()=>0)),r((()=>{d.value=o,a&&f({detail:{value:o}})}))}function f(t){d.value=t.detail.value;let a=s();e.mode.forEach(((t,l)=>{let o=d.value[l];if("year"==t&&(o+=e.startYear),"date"==t){o+=1;const e=a.endOf("month").date();o>e&&(o=e)}a=a.set(t,o)})),u.value=a.format(e.format),e.start&&a.isBefore(s(p(e.start)))&&m(e.start,!1),e.end&&a.isAfter(s(p(e.end)))&&m(e.end,!1)}function h(){a.popup.close()}return{date:u,columns:c,value:d,text:i,getDate:p,setDate:m,confirm:function(){t("update:modelValue",u.value),t("change",u.value),h()},onChange:f,refs:a,setRefs:n,open:function(){m(e.modelValue),a.popup.open()},close:h}}}),[["render",function(e,a,l,o,s,r){const V=n(u("cl-select-inner"),t),Y=_,j=y,D=k,R=n(u("cl-button"),C),S=n(u("cl-select-popup"),x);return d(),i(f,null,[c(Y,{class:"cl-select-date",onClick:e.open},{default:p((()=>[m(e.$slots,"default",{value:e.modelValue,label:e.modelValue},(()=>[c(V,{height:e.height,placeholder:e.placeholder,disabled:e.disabled,border:e.border,round:e.round,backgroundColor:e.backgroundColor,borderRadius:e.borderRadius,arrowIcon:"cl-icon-time",padding:e.padding,text:e.text},null,8,["height","placeholder","disabled","border","round","backgroundColor","borderRadius","padding","text"])]))])),_:3},8,["onClick"]),c(S,{ref:e.setRefs("popup"),title:e.title,"show-picker":!1},{list:p((()=>[c(Y,{class:"cl-select-date__wrap"},{default:p((()=>[c(D,{value:e.value,class:"cl-select-date__picker",onChange:e.onChange},{default:p((()=>[(d(!0),i(f,null,h(e.columns,((e,t)=>(d(),g(j,{key:t},{default:p((()=>[(d(!0),i(f,null,h(e.list,((t,a)=>(d(),g(Y,{class:"cl-select-date__picker-item",key:a},{default:p((()=>[v(b(t)+b(e.unit),1)])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1},8,["value","onChange"])])),_:1})])),confirm:p((()=>[c(R,{type:"primary",custom:"",onClick:e.confirm},{default:p((()=>[v("选择")])),_:1},8,["onClick"])])),_:1},8,["title"])],64)}]]);export{D as _};
