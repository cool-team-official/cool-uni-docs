import{a as e,c as l,b as s}from"./cl-page.C3y_EXfh.js";import{d as a,b as t,r,B as i,c as o,ad as c,ag as n,e as u,f as d,g as f,h as p,w as y,a2 as _,j as v,k as m,t as g,N as h,E as x,D as b,x as k,v as C,q as w,bm as j,bn as M,l as V}from"./index-Dlau7bkh.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as T}from"./cl-card.BPBZxryb.js";import{u as O}from"./index.AbH2Jzti.js";import{B as S}from"./bg1.D0gbE5sU.js";import"./cl-text.DUw3LhC2.js";const F=$(a({name:"cl- slider-verify",props:{type:{type:String,default:"fill"},image:{type:String,default:""},offset:{type:Number,default:5},title:String,placeholder:String},emits:["success","fail"],setup(e,{emit:l}){const{t:s}=t(),a=r(!1),u=r(!1),d=r(!0),f=i((()=>e.placeholder?e.placeholder:"fill"==e.type?s("请向右拖动滑块完成拼图"):s("请拖动滑块旋转至正确位置"))),p=r("wait"),y=o({x:0}),_=o({x:0});function v(){m(),"fill"==e.type&&(_.x=Math.ceil(250*Math.random())+200),"rotate"==e.type&&(_.x=Math.ceil(180*Math.random())+150)}function m(){y.x=0,p.value="wait",d.value=!1}function g(){a.value=!1}function h(){p.value="fail",l("fail"),setTimeout((()=>{m()}),500)}function x(){p.value="success",l("success"),g()}return{show:u,visible:a,lock:d,status:p,source:y,target:_,placeholder:f,open:function(){a.value=!0,c((()=>{v()}))},onOpened:function(){u.value=!0,d.value=!1},close:g,onClosed:function(){u.value=!1},onChange:function(l){if(!d.value)switch(e.type){case"fill":case"rotate":y.x=l.detail.x}},onTouchend:function(){if(!d.value)if(d.value=!0,"fill"==e.type)Math.abs(y.x-n(_.x))<=e.offset?x():h();else if("rotate"==e.type){const l=(y.x+_.x)%360,s=2*e.offset;l<=s||Math.abs(l-360)<=s?x():h()}},refresh:v}}}),[["render",function(l,s,a,t,r,i){const o=k,c=C,n=w,V=j,$=M,T=u(d("cl-popup"),e);return f(),p(T,{modelValue:l.visible,"onUpdate:modelValue":s[0]||(s[0]=e=>l.visible=e),"show-close-btn":"","border-radius":32,onOpened:l.onOpened,onClosed:l.onClosed},{default:y((()=>[_("div",{class:"cl-slider-verify"},[v(o,{class:"cl-slider-verify__title"},{default:y((()=>[m(g(l.title||l.$t("拖动验证")),1)])),_:1}),"fill"==l.type?(f(),p(c,{key:0,class:"cl-slider-verify__fill"},{default:y((()=>[v(c,{class:"cl-slider-verify__fill-icon cl-icon-refresh",onClick:l.refresh},null,8,["onClick"]),v(n,{class:"cl-slider-verify__fill-cover",src:l.image,mode:"aspectFill"},null,8,["src"]),v(c,{class:"cl-slider-verify__fill-source",style:h({left:`${l.source.x}px`})},{default:y((()=>[v(n,{src:l.image,style:h({left:`-${l.target.x}rpx`}),mode:"aspectFill"},null,8,["src","style"])])),_:1},8,["style"]),v(c,{class:"cl-slider-verify__fill-target",style:h({left:`${l.target.x}rpx`})},null,8,["style"])])),_:1})):"rotate"==l.type?(f(),p(c,{key:1,class:"cl-slider-verify__rotate"},{default:y((()=>[v(n,{class:"cl-slider-verify__rotate-cover",src:l.image,style:h({transform:`rotate(${l.source.x+l.target.x}deg)`}),mode:"aspectFill"},null,8,["src","style"])])),_:1})):x("",!0),v(c,{class:b(["cl-slider-verify__drag",[`is-${l.status}`]]),onTouchend:l.onTouchend,onMouseup:l.onTouchend},{default:y((()=>[v(c,{class:b(["cl-slider-verify__drag-active",{active:l.source.x>0}]),style:h({width:`${l.source.x}px`})},null,8,["class","style"]),v(c,{class:"cl-slider-verify__drag-placeholder"},{default:y((()=>[m(g(l.placeholder),1)])),_:1}),l.show?(f(),p($,{key:0,class:"cl-slider-verify__drag-inner"},{default:y((()=>[v(V,{class:"cl-slider-verify__drag-block",x:l.source.x,disabled:l.lock,animation:!1,direction:"horizontal",onChange:l.onChange},{default:y((()=>["success"==l.status?(f(),p(o,{key:0,class:"cl-icon-check"})):"fail"==l.status?(f(),p(o,{key:1,class:"cl-icon-close"})):(f(),p(o,{key:2,class:"cl-icon-arrow-right"}))])),_:1},8,["x","disabled","onChange"])])),_:1})):x("",!0)])),_:1},8,["class","onTouchend","onMouseup"])])])),_:1},8,["modelValue","onOpened","onClosed"])}]]),B=""+new URL("avatar4-DVr_nI3l.png",import.meta.url).href,D=a({name:"undefined"}),N=a({...D,setup(e){const{refs:a,setRefs:t}=O();return(e,r)=>{const i=u(d("cl-button"),l),o=u(d("cl-slider-verify"),F),c=u(d("cl-card"),T),n=C,_=u(d("cl-page"),s);return f(),p(_,{padding:20},{default:y((()=>[v(n,{class:"page"},{default:y((()=>[v(c,{label:"拖动验证"},{default:y((()=>[v(i,{onClick:r[0]||(r[0]=e=>{var l;return null==(l=V(a).sliderVerify)?void 0:l.open()})},{default:y((()=>[m("打开")])),_:1}),v(o,{title:"拖动验证",image:V(S),ref:V(t)("sliderVerify")},null,8,["image"])])),_:1}),v(c,{label:"旋转验证"},{default:y((()=>[v(i,{onClick:r[1]||(r[1]=e=>{var l;return null==(l=V(a).sliderVerify2)?void 0:l.open()})},{default:y((()=>[m("打开")])),_:1}),v(o,{title:"旋转验证",type:"rotate",image:V(B),ref:V(t)("sliderVerify2")},null,8,["image"])])),_:1})])),_:1})])),_:1})}}});export{N as default};
