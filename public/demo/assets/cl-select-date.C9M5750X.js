import{P as e,_ as t}from"./cl-select-inner.CmcS0Bxz.js";import{d as a,r as l,x as o,ap as r,a7 as s,a as n,b as u,c as d,i,f as c,w as p,R as m,F as f,j as g,e as h,g as v,t as b,l as _,bd as y,be as k}from"./index-BXs9N0aO.js";import{b as C}from"./cl-page.D0l32468.js";import{_ as x}from"./cl-select-popup.BRwefpLG.js";import{a as Y,_ as V}from"./_plugin-vue_export-helper.D4XvEQHf.js";import{r as j}from"./range.BgkBCZH6.js";const R=V(a({name:"cl-select-date",props:{...e,modelValue:String,title:{type:String,default:"选择日期"},startYear:{type:Number,default:2e3},mode:{type:Array,default:["year","month","date","hour","minute","second"]},format:{type:String,default:"YYYY-MM-DD HH:mm:ss"},displayFormat:Function,start:String,end:String,placeholder:{type:String,default:"请选择时间"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{refs:a,setRefs:n}=Y(),u=l(),d=l([]),i=o((()=>e.displayFormat?e.displayFormat(e.modelValue):e.modelValue)),c=o((()=>{const t=j(e.startYear,e.startYear+50),a=j(1,13),l=p(u.value).endOf("month").date(),o={year:{list:t,unit:"年"},month:{list:a,unit:"月"},date:{list:j(1,l+1),unit:"日"},hour:{list:j(24),unit:"时"},minute:{list:j(60),unit:"分"},second:{list:j(60),unit:"秒"}};return e.mode.map((e=>o[e]))}));function p(t){let a=r();if(t){let l=t.split(/\D+/g);e.mode.forEach(((e,t)=>{let o=Number(l[t]);"month"==e&&(o-=1),a=a.set(e,o)}))}return a}function m(t,a=!0){u.value=t||void 0;const l=p(u.value),o=e.mode.map(((e,t)=>{var a;let o=null==(a=l[e])?void 0:a.call(l);return"month"==e&&(o+=1),c.value[t].list.findIndex((e=>e==o))}));d.value=e.mode.map((()=>0)),s((()=>{d.value=o,a&&f({detail:{value:o}})}))}function f(t){d.value=t.detail.value;let a=r();e.mode.forEach(((t,l)=>{let o=d.value[l];if("year"==t&&(o+=e.startYear),"date"==t){o+=1;const e=a.endOf("month").date();o>e&&(o=e)}a=a.set(t,o)})),u.value=a.format(e.format),e.start&&a.isBefore(r(p(e.start)))&&m(e.start,!1),e.end&&a.isAfter(r(p(e.end)))&&m(e.end,!1)}function g(){a.popup.close()}return{date:u,columns:c,value:d,text:i,getDate:p,setDate:m,confirm:function(){t("update:modelValue",u.value),t("change",u.value),g()},onChange:f,refs:a,setRefs:n,open:function(){m(e.modelValue),a.popup.open()},close:g}}}),[["render",function(e,a,l,o,r,s){const Y=n(u("cl-select-inner"),t),V=_,j=y,R=k,S=n(u("cl-button"),C),D=n(u("cl-select-popup"),x);return d(),i(f,null,[c(V,{class:"cl-select-date",onClick:e.open},{default:p((()=>[m(e.$slots,"default",{value:e.modelValue,label:e.modelValue},(()=>[c(Y,{height:e.height,placeholder:e.placeholder,disabled:e.disabled,border:e.border,round:e.round,backgroundColor:e.backgroundColor,borderRadius:e.borderRadius,arrowIcon:"cl-icon-time",padding:e.padding,text:e.text},null,8,["height","placeholder","disabled","border","round","backgroundColor","borderRadius","padding","text"])]))])),_:3},8,["onClick"]),c(D,{ref:e.setRefs("popup"),title:e.title,"show-picker":!1},{list:p((()=>[c(V,{class:"cl-select-date__wrap"},{default:p((()=>[c(R,{value:e.value,class:"cl-select-date__picker",onChange:e.onChange},{default:p((()=>[(d(!0),i(f,null,g(e.columns,((e,t)=>(d(),h(j,{key:t},{default:p((()=>[(d(!0),i(f,null,g(e.list,((t,a)=>(d(),h(V,{class:"cl-select-date__picker-item",key:a},{default:p((()=>[v(b(t)+b(e.unit),1)])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1},8,["value","onChange"])])),_:1})])),confirm:p((()=>[c(S,{type:"primary",size:"large",round:"",fill:"",onClick:e.confirm},{default:p((()=>[v("选择")])),_:1},8,["onClick"])])),_:1},8,["title"])],64)}]]);export{R as _};
