import{_ as e}from"./cl-tag.CRZfAwUY.js";import{d as l,r as a,x as t,a6 as u,a7 as n,a as i,b as r,c as o,e as c,w as d,f as s,J as v,K as p,A as m,R as f,g as h,t as b,i as y,F as x,j as _,z as g,k,l as E,bf as w,h as V}from"./index-BXs9N0aO.js";import{_ as L}from"./cl-row.s15Ns3M2.js";import{g as C,p as j,i as S,b as H,a as B}from"./cl-page.D0l32468.js";import{_ as A,u as T}from"./_plugin-vue_export-helper.D4XvEQHf.js";import{c as K}from"./cloneDeep.CYJ2asS6.js";import{_ as N}from"./cl-card.CShwl3e9.js";import{_ as U}from"./cl-text.FIltvNqU.js";import{_ as O}from"./cl-list-item.B_gsDNCG.js";import{_ as R}from"./cl-select-popup.BRwefpLG.js";import"./isBoolean.XkqdrK9A.js";import"./cl-select-inner.CmcS0Bxz.js";import"./cl-empty.Db0daYvH.js";const z=A(l({name:"cl-tree-item",props:{data:{type:Object,default:()=>({})},siblings:{type:Array,default:()=>[]},level:{type:Number,default:0}},setup(e){const l=C("cl-tree",["value","updateValue","data","keys","getKey","rowHeight","checkStrictly","accordion","noChildren"]),i=a(e.data.isExpand||!1),r=a(),o=t((()=>({paddingLeft:(e.level?26:0)+"rpx"}))),c=t((()=>{var e,a;return{marginLeft:(null==(e=l.value)?void 0:e.noChildren)?0:d.value?"32rpx":"0",height:j(null==(a=l.value)?void 0:a.rowHeight)}})),d=t((()=>S(b("children")))),s=t((()=>{var e;return null==(e=l.value)?void 0:e.value.includes(b("value"))})),v=t((()=>b("label"))),p=t((()=>b("children")));function m(){var e;let a=0;return function e(l){l.forEach((l=>{a+=1,l.isExpand&&b("children",l)&&e(b("children",l))}))}(b("children")||[]),a*((null==(e=l.value)?void 0:e.rowHeight)||50)+"rpx"}let f;async function h(a=!0){b("children")&&(a&&(e.data.isExpand=!e.data.isExpand),clearTimeout(f),e.data.isExpand?(i.value=!0,r.value="0",await n(),setTimeout((()=>{r.value=m(),f=setTimeout((()=>{var a;r.value=void 0,(null==(a=l.value)?void 0:a.accordion)&&e.siblings.forEach((e=>{b("value",e)!==b("value")&&(e.isExpand=!1)}))}),300)}),50)):(r.value=m(),await n(),setTimeout((()=>{r.value="0rpx",f=setTimeout((()=>{i.value=!1}),300)}),50)))}function b(a,t){var u,n;return t||(t=e.data),null==(n=null==(u=l.value)?void 0:u.getKey)?void 0:n.call(u,a,t)}return u((()=>e.data.isExpand),(e=>{e||h(!1)})),{isExpand:i,maxHeight:r,itemStyle:o,childStyle:c,isLeaf:d,isChecked:s,label:v,children:p,toExpand:h,getKey:b,toTap:function(){var e;d.value||(null==(e=l.value)?void 0:e.checkStrictly)?function(){var e;null==(e=l.value)||e.updateValue(b("value"))}():h()}}}}),[["render",function(e,l,a,t,u,n){const w=k,V=E,L=i(r("cl-tree-item"),z);return o(),c(V,{class:g(["cl-tree-item",{"is-expand":e.data.isExpand,"is-checked":e.isChecked}]),style:v(e.itemStyle)},{default:d((()=>[s(V,{class:"cl-tree-item__content",style:v(e.childStyle),onClick:e.toTap},{default:d((()=>[e.isLeaf?m("",!0):(o(),c(V,{key:0,class:"cl-tree-item__expand",onClick:l[0]||(l[0]=p((l=>e.toExpand()),["stop"]))},{default:d((()=>[s(w,{class:"icon-caret cl-icon-caret-bottom"})])),_:1})),s(V,{class:"cl-tree-item__label"},{default:d((()=>[f(e.$slots,"item",{data:e.data,level:e.level},(()=>[h(b(e.label),1)]))])),_:3}),s(w,{class:"cl-tree-item__check cl-icon-check"})])),_:3},8,["style","onClick"]),e.isExpand?(o(),c(V,{key:0,class:"cl-tree-item__children",style:v({maxHeight:e.maxHeight})},{default:d((()=>[(o(!0),y(x,null,_(e.children,((l,a)=>(o(),c(L,{data:l,siblings:e.children,key:a,level:e.level+1},null,8,["data","siblings","level"])))),128))])),_:1},8,["style"])):m("",!0)])),_:3},8,["class","style"])}]]),M={modelValue:[String,Number,Array],data:{type:Array,default:()=>[]},multiple:Boolean,rowHeight:{type:Number,default:64},checkStrictly:Boolean,defaultExpandAll:Boolean,autoExpand:{type:Boolean,default:!0},accordion:Boolean,keys:Object};function P({props:e,emit:l}){const n=a([]);u((()=>e.modelValue),(l=>{n.value=e.multiple?l:[l]}),{immediate:!0});const i=t((()=>w({label:"label",value:"value",children:"children"},e.keys)));function r(e,l){return l[i.value[e]]}const o=t((()=>{const l=[];return function e(a){a.forEach((a=>{n.value.includes(r("value",a))&&l.push(r("label",a)),r("children",a)&&e(r("children",a))}))}(e.data),l.join("、")})),c=a([]),d=t((()=>!c.value.find((e=>e.children))));return u((()=>e.data),(function(l){const a=K(l);!function l(a,t){a.forEach((a=>{e.autoExpand&&n.value.includes(r("value",a))&&t&&(t.isExpand=!0),r("children",a)&&(e.defaultExpandAll&&(a.isExpand=!0),l(r("children",a),a),(null==a?void 0:a.isExpand)&&t&&(t.isExpand=!0))}))}(a),c.value=a}),{immediate:!0}),{value:n,updateValue:function(a){if(e.multiple){const e=n.value.indexOf(a);e>=0?n.value.splice(e,1):n.value.push(a)}else n.value=[a];const t=e.multiple?n.value:n.value[0];l("update:modelValue",t),l("change",t)},keys:i,getKey:r,label:o,data:c,noChildren:d}}const D=A(l({name:"cl-tree",props:{...M},emits:["update:modelValue","change"],setup:(e,{emit:l})=>({...P({props:e,emit:l})})}),[["render",function(e,l,a,t,u,n){const s=i(r("cl-tree-item"),z),v=E;return o(),c(v,{class:"cl-tree"},{default:d((()=>[(o(!0),y(x,null,_(e.data,((l,a)=>(o(),c(s,{key:a,data:l,siblings:e.data},null,8,["data","siblings"])))),128))])),_:1})}]]);const F=A(l({name:"cl-tree-select",props:{maxHeight:{type:[String,Number],default:800},showPicker:{type:Boolean,default:!0},...M},emits:["update:modelValue","change"],setup(e,{emit:l}){const{label:u}=P({props:e}),n=a(),i=a(!1),r=a(),o=t((()=>!(e.multiple?S(r.value):void 0===r.value||null===r.value||""===r.value)));function c(){var e;null==(e=n.value)||e.close()}return{popup:n,visible:i,value:r,label:u,open:function(){var l;i.value=!0,r.value=K(e.modelValue),null==(l=n.value)||l.open()},close:c,save:function(){l("update:modelValue",r.value),l("change",r.value),c()},onClose:function(){i.value=!1},parseRpx:j,isChecked:o}}}),[["render",function(e,l,a,t,u,n){const v=i(r("cl-tree"),D),p=E,f=i(r("cl-button"),H),b=i(r("cl-select-popup"),R);return o(),c(b,{ref:"popup",title:"选择节点","max-height":e.maxHeight,"show-picker":e.showPicker,onClose:e.onClose},{list:d((()=>[s(p,{class:"cl-tree-select"},{default:d((()=>[e.visible?(o(),c(v,{key:0,modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=l=>e.value=l),data:e.data,"row-height":e.rowHeight,"check-strictly":e.checkStrictly,"default-expand-all":e.defaultExpandAll,"auto-expand":e.autoExpand,accordion:e.accordion,multiple:e.multiple,keys:e.keys},null,8,["modelValue","data","row-height","check-strictly","default-expand-all","auto-expand","accordion","multiple","keys"])):m("",!0)])),_:1})])),confirm:d((()=>[s(f,{round:"",fill:"",type:"primary",size:"large",disabled:!e.isChecked,onClick:e.save},{default:d((()=>[h("确定")])),_:1},8,["disabled","onClick"])])),_:1},8,["max-height","show-picker","onClose"])}]]),I=A(l({__name:"tree",setup(l){const{refs:t,setRefs:u}=T(),n=a(3),v=a([12,3]),p=a(),m=a([{label:"Level one 1",value:1,children:[{label:"Level two 1-1",value:2,children:[{label:"Level three 1-1-1",value:3}]}]},{label:"Level one 2",value:4,children:[{label:"Level two 2-1",value:5,children:[{label:"Level three 2-1-1",value:6,children:[{label:"Level four 2-1-1-1",value:14,children:[{label:"Level five 2-1-1-1-1",value:16}]},{label:"Level four 2-1-1-2",value:15,children:[{label:"Level five 2-1-1-2-1",value:17}]}]}]},{label:"Level two 2-2",value:7}]},{label:"Level one 3",value:8,children:[{label:"Level two 3-1",value:9,children:[{label:"Level three 3-1-1",value:10}]},{label:"Level two 3-2",value:11,children:[{label:"Level three 3-2-1",value:12}]}]},{label:"Level one 4",value:13}]);return(l,a)=>{const f=i(r("cl-tag"),e),y=i(r("cl-row"),L),x=i(r("cl-tree"),D),_=E,g=i(r("cl-card"),N),k=i(r("cl-text"),U),w=i(r("cl-list-item"),O),C=i(r("cl-tree-select"),F),j=i(r("cl-page"),B);return o(),c(j,{padding:20},{default:d((()=>[s(g,{label:"基础用法"},{default:d((()=>[s(y,{margin:[0,0,10,0]},{default:d((()=>[s(f,null,{default:d((()=>{var e;return[h(b(null==(e=V(t).tree)?void 0:e.label),1)]})),_:1})])),_:1}),s(f,{type:"error"},{default:d((()=>[h(b(n.value),1)])),_:1}),s(_,{class:"bor"},{default:d((()=>[s(x,{ref:V(u)("tree"),modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),data:m.value},null,8,["modelValue","data"])])),_:1})])),_:1}),s(g,{label:"多选"},{default:d((()=>[s(y,{margin:[0,0,10,0]},{default:d((()=>[s(f,null,{default:d((()=>{var e;return[h(b(null==(e=V(t).treeMultiple)?void 0:e.label),1)]})),_:1})])),_:1}),s(f,{type:"error"},{default:d((()=>[h(b(v.value),1)])),_:1}),s(_,{class:"bor"},{default:d((()=>[s(x,{multiple:"",ref:V(u)("treeMultiple"),modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),data:m.value},null,8,["modelValue","data"])])),_:1})])),_:1}),s(g,{label:"弹出框选择"},{default:d((()=>{var e;return[s(w,{"arrow-icon":!1,label:"节点选择",onClick:null==(e=V(t).treeSelect)?void 0:e.open},{default:d((()=>{var e;return[s(k,{value:(null==(e=V(t).treeSelect)?void 0:e.label)||"请选择",ellipsis:1},null,8,["value"])]})),_:1},8,["onClick"]),s(C,{ref:V(u)("treeSelect"),modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value=e),data:m.value,"show-picker":!1},null,8,["modelValue","data"])]})),_:1})])),_:1})}}}),[["__scopeId","data-v-bef1b131"]]);export{I as default};
