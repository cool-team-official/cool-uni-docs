import{c as e,b as l,a as s}from"./cl-page.D-7WxXOa.js";import{d as a,f as t,c as r,A as i,ab as o,u as c,k as n,l as u,o as f,a as d,w as p,_ as y,p as _,q as v,t as m,b as g,G as h,n as x,y as b,i as k,H as C,bh as w,bi as M,s as V}from"./index-BsPE-n5_.js";import{_ as j,u as $}from"./_plugin-vue_export-helper.B5Vkt9du.js";import{_ as T}from"./cl-card.CcFW5yJQ.js";import{B as O}from"./bg1.D0gbE5sU.js";import"./cl-text.Dmi3_oh8.js";const S=j(a({name:"cl- slider-verify",props:{type:{type:String,default:"fill"},image:{type:String,default:""},offset:{type:Number,default:5},title:{type:String,default:"拖动验证"},placeholder:String},emits:["success","fail"],setup(e,{emit:l}){const s=t(!1),a=t(!1),n=t(!0),u=r((()=>e.placeholder?e.placeholder:"fill"==e.type?"请向右拖动滑块完成拼图":"请拖动滑块旋转至正确位置")),f=t("wait"),d=i({x:0}),p=i({x:0});function y(){_(),"fill"==e.type&&(p.x=Math.ceil(250*Math.random())+200),"rotate"==e.type&&(p.x=Math.ceil(200*Math.random())+100)}function _(){d.x=0,f.value="wait",n.value=!1}function v(){s.value=!1}function m(){f.value="fail",l("fail"),setTimeout((()=>{_()}),500)}function g(){f.value="success",l("success"),v()}return{show:a,visible:s,lock:n,status:f,source:d,target:p,placeholder:u,open:function(){s.value=!0,o((()=>{y()}))},onOpened:function(){a.value=!0,n.value=!1},close:v,onClosed:function(){a.value=!1},onChange:function(l){if(!n.value)switch(e.type){case"fill":case"rotate":d.x=l.detail.x}},onTouchend:function(){if(!n.value)if(n.value=!0,"fill"==e.type)Math.abs(d.x-c(p.x))<=e.offset?g():m();else if("rotate"==e.type){const l=(d.x+p.x)%360,s=2*e.offset;l<=s||Math.abs(l-360)<=s?g():m()}},refresh:y}}}),[["render",function(l,s,a,t,r,i){const o=b,c=k,V=C,j=w,$=M,T=n(u("cl-popup"),e);return f(),d(T,{modelValue:l.visible,"onUpdate:modelValue":s[0]||(s[0]=e=>l.visible=e),"show-close-btn":"","border-radius":32,onOpened:l.onOpened,onClosed:l.onClosed},{default:p((()=>[y("div",{class:"cl-slider-verify"},[_(o,{class:"cl-slider-verify__title"},{default:p((()=>[v(m(l.title),1)])),_:1}),"fill"==l.type?(f(),d(c,{key:0,class:"cl-slider-verify__fill"},{default:p((()=>[_(c,{class:"cl-slider-verify__fill-icon cl-icon-refresh",onClick:l.refresh},null,8,["onClick"]),_(V,{class:"cl-slider-verify__fill-cover",src:l.image,mode:"aspectFill"},null,8,["src"]),_(c,{class:"cl-slider-verify__fill-source",style:g({left:`${l.source.x}px`})},{default:p((()=>[_(V,{src:l.image,style:g({left:`-${l.target.x}rpx`}),mode:"aspectFill"},null,8,["src","style"])])),_:1},8,["style"]),_(c,{class:"cl-slider-verify__fill-target",style:g({left:`${l.target.x}rpx`})},null,8,["style"])])),_:1})):"rotate"==l.type?(f(),d(c,{key:1,class:"cl-slider-verify__rotate"},{default:p((()=>[_(V,{class:"cl-slider-verify__rotate-cover",src:l.image,style:g({transform:`rotate(${l.source.x+l.target.x}deg)`}),mode:"aspectFill"},null,8,["src","style"])])),_:1})):h("",!0),_(c,{class:x(["cl-slider-verify__drag",[`is-${l.status}`]]),onTouchend:l.onTouchend,onMouseup:l.onTouchend},{default:p((()=>[_(c,{class:x(["cl-slider-verify__drag-active",{active:l.source.x>0}]),style:g({width:`${l.source.x}px`})},null,8,["class","style"]),_(c,{class:"cl-slider-verify__drag-placeholder"},{default:p((()=>[v(m(l.placeholder),1)])),_:1}),l.show?(f(),d($,{key:0,class:"cl-slider-verify__drag-inner"},{default:p((()=>[_(j,{class:"cl-slider-verify__drag-block",x:l.source.x,disabled:l.lock,animation:!1,direction:"horizontal",onChange:l.onChange},{default:p((()=>["success"==l.status?(f(),d(o,{key:0,class:"cl-icon-check"})):"fail"==l.status?(f(),d(o,{key:1,class:"cl-icon-close"})):(f(),d(o,{key:2,class:"cl-icon-arrow-right"}))])),_:1},8,["x","disabled","onChange"])])),_:1})):h("",!0)])),_:1},8,["class","onTouchend","onMouseup"])])])),_:1},8,["modelValue","onOpened","onClosed"])}]]),F=""+new URL("avatar4-DVr_nI3l.png",import.meta.url).href,R=a({__name:"slider-verify",setup(e){const{refs:a,setRefs:t}=$();return(e,r)=>{const i=n(u("cl-button"),l),o=n(u("cl-slider-verify"),S),c=n(u("cl-card"),T),y=k,m=n(u("cl-page"),s);return f(),d(m,{padding:20},{default:p((()=>[_(y,{class:"page"},{default:p((()=>[_(c,{label:"拖动验证"},{default:p((()=>[_(i,{onClick:r[0]||(r[0]=e=>{var l;return null==(l=V(a).sliderVerify)?void 0:l.open()})},{default:p((()=>[v("打开")])),_:1}),_(o,{title:"拖动验证",image:V(O),ref:V(t)("sliderVerify")},null,8,["image"])])),_:1}),_(c,{label:"旋转验证"},{default:p((()=>[_(i,{onClick:r[1]||(r[1]=e=>{var l;return null==(l=V(a).sliderVerify2)?void 0:l.open()})},{default:p((()=>[v("打开")])),_:1}),_(o,{title:"旋转验证",type:"rotate",image:V(F),ref:V(t)("sliderVerify2")},null,8,["image"])])),_:1})])),_:1})])),_:1})}}});export{R as default};
